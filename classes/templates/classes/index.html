{% extends 'classes/layout.html' %}

{% load static %}

{% block content %}

{% if building %}
<div class="card">
    <div class="card-content">
        {{building.building}}
    </div>
</div>
{% elif %}
    <h6 class="center-align">{{c}}</h6>
    <div class="card">
        <div class="card-content">
            {{c.building}} {{c.room}} {{c.day}} {{c.time}}
        </div>
    </div>
{% endif %}

<link rel="stylesheet" type="text/css" href="{% static 'classes/assets/css/bootstrap.min.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'classes/dist/bootstrap-clockpicker.min.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'classes/assets/css/github.min.css' %}">

<form method="GET" action="{% url 'classes:search' %}">
    <input name = "q" value="{{request.GET.q}}" placeholder="Search dept/course num... ex: COS 333">
    <button class="btn btn-success" type="submit">
        Search
    </button>
</form>


<div style="width:30%; float:right;">
  <div class="input-group clockpicker pull-center"  data-autoclose="true">
    <input type="text" class="form-control">
    <span class="input-group-addon">
      <span class="glyphicon glyphicon-time"></span>
    </span>
  </div>
</div>


<html>
<head>
  <title>ClassMaps</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="shortcut icon" type="image/x-icon" href="http://leafletjs.com/examples/layers-control/docs/images/favicon.ico">

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>

  <script type="text/javascript" src="{% static 'classes/assets/js/jquery.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'classes/assets/js/bootstrap.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'classes/dist/bootstrap-clockpicker.min.js' %}"></script>
  <script type="text/javascript">
    $('.clockpicker').clockpicker({
      twelvehour: true,
    })
    .find('input').change(function(){
      console.log(this.value);
    });
    var input = $('#single-input').clockpicker({
      placement: 'bottom',
      align: 'left',
      autoclose: true,
      default: 'now'
    });
</script>


<style>
  #map { width: 100%; height: 600px; }
  .slidecontainer {
      margin: 0 auto;
      width: 350px;
  }
</style>
</head>

<div class="dropdown">
  <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Day of the Week
  </button>
  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
    <a class="dropdown-item" href="#M">Monday</a>
    <a class="dropdown-item" href="#T">Tuesday</a>
    <a class="dropdown-item" href="#W">Wednesday</a>
    <a class="dropdown-item" href="#Th">Thursday</a>
    <a class="dropdown-item" href="#F">Friday</a>
  </div>
</div>
  <div id="map"></div>
  <script>
    // Adds different layer groups
    var printers = L.layerGroup();

    var printerLocs = [['40.34614', '-74.660091', '1901 Hall - Ground Floor', '6'],
 ['40.345863', '-74.656253', '1937 Hall - Ground Floor', '6'],
 ['40.344532', '-74.655534', '1976 Hall - Room 33', '6'],
 ['40.343418', '-74.655867', 'Bloomberg Hall - Room 315', '6'],
 ['40.347546', '-74.654514', 'Campus Club - 2nd Floor', '6'],
 ['40.346659', '-74.653703', 'Center for Jewish Life - 2nd Floor', '6'],
 ['40.34714524', '-74.65927882', 'Edwards Hall - Basement', '6'],
 ['40.349123', '-74.651827', 'Fields Center - Room 308', '6'],
 ['40.349582', '-74.657495', 'Firestone Library - Room B-4-K', '6'],
 ['40.342214', '-74.661144', 'Forbes College - Library, Room 32', '6'],
 ['40.342214', '-74.661144', 'Forbes College - Rooms 21, 22', '6'],
 ['40.350268', '-74.652827', 'Friend Center - Room 016', '6'],
 ['40.350268', '-74.652827', 'Friend Center - Room 017', '6'],
 ['40.34673', '-74.655259', 'Frist Campus Center - 100 Level', '6'],
 ['40.34673', '-74.655259', 'Frist Campus Center - 200 Level', '6'],
 ['40.34673', '-74.655259', 'Frist Campus Center - 300 Level', '6'],
 ['40.348599', '-74.661556', 'Holder Hall - Room B11', '6'],
 ['40.348599', '-74.661556', 'Holder Hall - Room B31', '6'],
 ['40.34491', '-74.656064', 'Julian Street Library', '6'],
 ['40.343615', '-74.658358', 'Lauritzen Hall - Room 409', '6'],
 ['40.333379', '-74.657018', 'Lawrence Apartments - Building 1', '6'],
 ['40.333379', '-74.657018', 'Lawrence Apartments - Building 14', '6'],
 ['40.346679', '-74.659941', 'Little Hall - Basement', '6'],
 ['40.348433', '-74.66236', 'Madison Hall - Room G17', '6'],
 ['40.348307', '-74.656521', 'McCosh Hall - Room B59', '6'],
 ['40.345334', '-74.652546', 'McDonnell Hall - Brush Gallery', '6'],
 ['40.340914', '-74.666387', 'New Graduate College - Entry 33/34', '6'],
 ['40.344305', '-74.658391', 'North Hall - Library', '6'],
 ['40.340903', '-74.665119', 'Old Graduate College - Room B-9-B', '6'],
 ['40.347788', '-74.656319', 'Architecture Library - 2nd Floor', '28'],
 ['40.34673', '-74.655259', 'East Asian Library - Frist Campus Center', '28'],
 ['40.346412', '-74.655946', 'East Asian Library - Jones Hall', '28'],
 ['40.350268', '-74.652827', 'Engineering Library - 2nd Floor', '28'],
 ['40.345701', '-74.652474', 'Fine Hall Library - Basement', '28'],
 ['40.349582', '-74.657495', 'Firestone Library - 1st Floor, Reserve', '28'],
 ['40.349582', '-74.657495', 'Firestone Library - 3rd Floor', '28'],
 ['40.349582', '-74.657495', 'Firestone Library - A Floor', '28'],
 ['40.349582', '-74.657495', 'Firestone Library - A Floor - Reserve', '28'],
 ['40.349582', '-74.657495', 'Firestone Library - B Floor', '28'],
 ['40.349582', '-74.657495', 'Firestone Library - C Floor', '28'],
 ['40.34673', '-74.655259', 'Frist Campus Center - 100 Level', '28'],
 ['40.34624', '-74.6528', 'Lewis Library - 1st Floor', '28'],
 ['40.34624', '-74.6528', 'Lewis Library - 2nd Floor', '28'],
 ['40.34624', '-74.6528', 'Lewis Library - A Floor', '28'],
 ['40.347274', '-74.658045', 'Marquand Library', '28'],
 ['40.347239', '-74.655894', 'Music Library - Woolworth', '28'],
 ['40.349789', '-74.656103', 'Psychology Library', '28'],
 ['40.349194', '-74.653644', 'Stokes Library - Basement', '28'],
 ['40.351069', '-74.654141', '201 Nassau Street', '92'],
 ['40.34365', '-74.657332', '1981 Hall - Room B10', '29'],
 ['40.347445', '-74.661497', 'Blair Hall - Entry 11', '29'],
 ['40.346367', '-74.657862', 'Brown Hall - Basement', '29'],
 ['40.34678', '-74.658659', 'Dod Hall - Lower Level', '29'],
 ['40.344653', '-74.658267', 'Fisher Hall Dorm - Room 213', '29'],
 ['40.346321', '-74.660941', 'Foulke Hall - Basement', '29'],
 ['40.346014', '-74.655508', 'McCosh Health Center - Solarium', '29'],
 ['40.345359', '-74.659666', 'Pyne Hall - Room 231', '29'],
 ['40.344386', '-74.654874', 'Scully Hall - Room 269A', '29'],
 ['40.344386', '-74.654874', 'Scully Hall - Room 309', '29'],
 ['40.344653', '-74.659248', 'Spelman Halls - Laundry Room', '29'],
 ['40.34745173', '-74.66012844', 'Witherspoon Hall - Room 109', '29'],
 ['40.34570028', '-74.65758615', 'Wright Hall - 3rd Floor', '29'],
 ['40.344719', '-74.656574', 'Wu Hall - Mellon Library', '29'],
 ['40.34673', '-74.655259', 'Frist Campus Center - 100 Level', '30'],
 ['40.34673', '-74.655259', 'Frist Campus Center - B Level', '30']];

     var printerIcon = L.icon({
       iconUrl: 'http://www.cs.princeton.edu/~yangsong/printer_icon.png',

       iconSize:     [28, 28], // size of the icon
       iconAnchor:   [14, 14], // point of the icon which will correspond to marker's location
       popupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor
     })

    for (var i = 0; i < printerLocs.length; i++) {
  //if (hi[i][3] == '6' || hi[i][3] == '29')
    if (printerLocs[i][3] == '6') L.marker([printerLocs[i][0], printerLocs[i][1]], {icon: printerIcon}).bindPopup(printerLocs[i][2]).addTo(printers);
    if (printerLocs[i][3] == '29') L.marker([printerLocs[i][0], printerLocs[i][1]], {icon: printerIcon}).bindPopup(printerLocs[i][2]).addTo(printers);
    if (printerLocs[i][3] == '28') L.marker([printerLocs[i][0], printerLocs[i][1]], {icon: printerIcon}).bindPopup(printerLocs[i][2]).addTo(printers);
 }

    // URLS of maps for different laters (note: need to add attributes)
    var mbAttr = 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
      '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
      'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
    mbUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'

    // Different layers
    var regular   = L.tileLayer(mbUrl, {id: 'mapbox.light', attribution: mbAttr})

    // Initializes the map
    var map = L.map('map', {
      center: [40.346, -74.653],
      zoom: 16,
      layers: [regular]
    });

    // Our different layers
    var baseLayers = {
      "Regular": regular
    };

    // Our overlays
    var overlays = {
      "Printers": printers
    };

    // Adds overlays and layers to map
    L.control.layers(baseLayers, overlays).addTo(map);

    // Limits zoom (we could get rid of this)
    map.options.minZoom = 14;
    map.options.maxZoom = 18;

    // Displays current user location and accuracy
    function onLocationFound(e) {
      var radius = e.accuracy / 2;

      L.marker(e.latlng).addTo(map).bindPopup("You are within " + radius + " meters from this point").openPopup();

      L.circle(e.latlng, radius).addTo(map);
    }
    map.on('locationfound', onLocationFound);

    // Displays coordinates upon mouse click
    var popup = L.popup();
    function onMapClick(e) {
      popup
        .setLatLng(e.latlng)
        .setContent("You clicked the map at " + e.latlng.toString())
        .openOn(map);
    }
    map.on('click', onMapClick);
  </script>
  <script>
    {% if building %}
        var c = "{{building.building}}";
        var d = "";
        var loc2 = "{{building.building_lon}}";
        var loc1 = "{{building.building_lat}}";
    {% elif c %}
        var c = "{{c.building}}";
        var d = "{{c.room}}";
        var loc2 = "{{c.building_lon}}";
        var loc1 = "{{c.building_lat}}";
    {% endif %}
     L.marker([loc1, loc2]).addTo(map)
    .bindPopup(c + " " + d).openPopup();
  </script>

</body>
</html>

{% endblock %}
